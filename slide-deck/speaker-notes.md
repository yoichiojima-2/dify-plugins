# からあげ店長クン — スピーカーノート

**Dify Plugin Competition 2026 | 尾嶋洋一 | 15分**

---

## Slide 1 — タイトル [0:00〜0:30]

- 「からあげ店長クン」というDifyプラグインを作った
- コンビニ店長の業務を自律的に実行するAIエージェント
- 15分で仕組み・デモ・なぜこれを作ったかを話す

---

## Slide 2 — なぜコンビニ店長か [0:30〜2:00]

- 全国56,000店のコンビニ。業績は店長の判断力に依存
- 根っこにあるのは「属人化」の問題：
  - **発注判断** — ベテランの経験と勘頼り。人が変われば精度も変わる
  - **業績格差** — 同じ立地・品揃えでも、店長次第で結果が違う
  - **新人育成** — 一人前になるまでのミスが直接ロスになる
  - **本部施策** — 「天気を見て調整して」と言われても、具体的な数字が出せない
- からあげ店長クンは、この属人的な判断をデータとツールで再現可能にする

---

## Slide 3 — 作ったもの [2:00〜3:00]

- 普通のチャットボットは「こうしましょう」とアドバイスするだけ
- からあげ店長クンは、成果物を実際に作って渡す
- 3つの主要機能：
  - **天気×ML需要予測** — 天気→需要予測→在庫確認→発注数を算出
  - **売上ダッシュボード** — DBからデータ取得→KPI計算→HTMLグラフをチャット内に描画
  - **シフト管理** — シフト表の表示・変更、欠勤時の代打提案、LINE依頼文の自動生成
- 13個の業務ツールを搭載。どれをどの順で使うかはLLMが判断
- 開発者はツールだけ用意して、手順は書かない

---

## Slide 4 — エージェントとは [3:00〜4:00]

- チャットフローは手順が固定。開発者が決めたフロー通りに動く
- エージェントモードはLLMが自律的に判断
  - Think（考える）→ Act（実行する）→ Observe（結果を見る）のループ
- 具体例：「明日の発注を最適化して」
  - T: 天気と在庫を確認すべき → A: `hourly_weather`実行 → O: 晴れ・32°C
  - T: 気温が高い、飲料需要を予測 → A: `demand_forecast`実行 → O: 飲料+40%、アイス+25%
  - T: 在庫と照合して発注数を出す → A: `order_optimizer`実行 → O: 発注推奨リスト完成
- この順番はLLMが自分で考えた。開発者はフローを書いていない

---

## Slide 5 — ツール構成 [4:00〜4:30]

- 全13ツール、6カテゴリ：
  - **売上・ダッシュボード (3)** — `sales_analytics`, `dashboard_generator`, `dashboard_template`
  - **需要予測・発注 (3)** — `hourly_weather`, `demand_forecast`, `order_optimizer`
  - **シフト・LINE連絡 (4)** — `shift_manager`, `shift_optimizer`, `shift_table_generator`, `line_composer`
  - **在庫管理 (1)** — `inventory_manager`
  - **商品情報・共通基盤 (2)** — `lawson_items`, `datetime_utils`
- 細かい説明はスキップ。デモで実際に動くところを見てもらう

---

## Slide 6 — デモ① 売上ダッシュボード [4:30〜6:30]

**※ 録画再生: `売上ダッシュボード作成と深掘分析.mp4`**

- 一番シンプルなユースケースから
- プロンプト：「今週の売上ダッシュボードを作って」
- エージェントの動き：
  - `sales_analytics` でDBから売上データを取得
  - `dashboard_generator` でKPI計算、HTMLレポート生成
  - `dashboard_template` でグラフ付きダッシュボードに仕上げ
- ポイント：
  - グラフ付きレポートがチャット画面にそのまま出る
  - Excelを開く必要がない
  - 話しかけるだけで出てくる成果物

---

## Slide 7 — デモ② 天気連動の発注最適化 [6:30〜9:00]

**※ 録画再生: `天気による需要予測と在庫最適化.mp4`**

- 技術的に一番面白いところ。天気・需要予測・在庫を一気につなぐ
- プロンプト：「天気を見て明日の発注を最適化して」
- エージェントの動き：
  - `hourly_weather` で天気予報取得 → 晴れ・最高32°C
  - `demand_forecast` でML需要予測 → 飲料+40%、アイス+25%
  - `inventory_manager` で在庫照合 → 飲料在庫が不足
  - `order_optimizer` で発注推奨数を算出
- ポイント：
  - 勘と経験ではなく、データに基づく発注判断
  - ベテラン店長の暗黙知を、誰でも使えるシステムに変えている

---

## Slide 8 — デモ③ 急な欠勤対応 [9:00〜10:30]

**※ 録画再生: `シフト管理.mp4`**

- 個人的に一番好きなシナリオ。急な欠勤への対応
- プロンプト：「田中さんが明日休みになった。シフトを更新してLINEの交代依頼文も作って」
- エージェントの動き：
  - `shift_manager` でシフトDB更新 → 田中さんのシフト削除
  - `shift_optimizer` で代替スタッフ検索 → 佐藤さんが出勤可能
  - `shift_table_generator` で新シフト表HTML生成
  - `line_composer` でLINE交代依頼文を作成
- ポイント：
  - 1つの文章で4つの作業が連鎖
  - 普通なら電話→シフト表修正→LINE作成で30分かかる作業
  - 深夜0時でも動く

**デモ後のつなぎ：**
- 3つのデモに共通するのは「話しかけるだけで成果物が手に渡る」体験

---

## Slide 9 — まとめ [10:30〜12:00]

- 開発者はツールを作る。どう使うかはLLMが決める
- 13個の業務ツールをエージェントに持たせた
  - 売上分析、ダッシュボード、シフト管理、需要予測、在庫管理、LINE連絡、発注最適化
  - 全部動く
- 技術スタック：
  - Dify Agent Mode
  - DuckDBインメモリ
  - RandomForestの需要予測
  - Open-Meteo天気API（無料、キー不要）
  - インラインHTML描画
- ありがとうございました

---

## Q&A 想定質問 [12:00〜15:00]

**Q: データはどこから？本物のPOSデータ？**
- シードデータ（架空のチェーン）を使用
- 本番はDuckDBをPostgreSQLに差し替えるだけの設計

**Q: なぜDify？**
- エージェント実行環境として成熟、プラグインエコシステムがある
- ツールを宣言的に書ける

**Q: LINEへの実際の送信は？**
- 今回はメッセージ生成まで
- LINE Messaging API連携で拡張可能だがPOCのスコープ外

**Q: 精度は？間違えた発注のリスクは？**
- 実運用では「提案＋人間の確認」フローにすべき
- エージェントが直接発注システムに書き込む構成は慎重に設計する必要あり

**Q: エージェントという考え方はオリジナル？**
- 概念自体は自分の発明ではない
- 実際のコンビニ業務に、動く13ツールとして落とし込んだのがこの作品

---

## タイム管理

| 経過 | スライド | チェック |
|------|----------|----------|
| 0:30 | 2. なぜコンビニ | 課題提示から入る |
| 2:00 | 3. 作ったもの | 2分でセットアップ完了 |
| 4:00 | 5. ツール構成 | 説明パート終了 |
| 4:30 | 6. デモ開始 | メインパート |
| 10:30 | 9. まとめ | デモに6分使えたか確認 |
| 12:00 | Q&A | バッファ3分 |

**動画トラブル時:** スライド左側のツール連鎖リストを指して口頭で説明

**時間が余った時:** デモの実況をゆっくり。Q&Aを長めに

**時間が足りない時:** Slide 5を「13ツール6カテゴリです」で飛ばす。デモ③を短縮
